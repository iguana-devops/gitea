<div class="ui attached table segment commit-table">
	<div class="ui very basic striped table unstackable" id="commits-table">
		<ul class="commit-list tw-list-none tw-divide-y tw-divide-secondary tw-p-0 tw-m-0">
			{{$commitRepoLink := $.RepoLink}}{{if $.CommitRepoLink}}{{$commitRepoLink = $.CommitRepoLink}}{{end}}
			{{range .Commits}}
				<li class="tw-grid tw-gap-1 tw-px-4 tw-py-2 tw-items-center tw-grid-cols-[minmax(30%,1fr)_minmax(0px,max-content)]">
					<div class="message">
						<span class="message-wrapper">
						{{if $.PageIsWiki}}
							<span class="commit-summary{{if gt .ParentCount 1}} grey text{{end}}" title="{{.Summary}}">{{.Summary | RenderEmoji $.Context}}</span>
						{{else}}
							{{$commitLink:= printf "%s/commit/%s" $commitRepoLink (PathEscape .ID.String)}}
							<span class="commit-summary{{if gt .ParentCount 1}} grey text{{end}}" title="{{.Summary}}">{{RenderCommitMessageLinkSubject $.Context .Message $commitLink ($.Repository.ComposeMetas ctx)}}</span>
						{{end}}
						</span>
						{{if IsMultilineCommitMessage .Message}}
						<button class="ui button js-toggle-commit-body ellipsis-button tw-ml-1" aria-expanded="false">...</button>
						{{end}}
						{{if IsMultilineCommitMessage .Message}}
						<pre class="commit-body tw-hidden tw-text-xs tw-mt-2">{{RenderCommitBody $.Context .Message ($.Repository.ComposeMetas ctx)}}</pre>
						{{end}}
					</div>
					<div class="author tw-row-start-2 tw-text-text-light-2">
						<div class="tw-flex tw-items-center tw-gap-1">
							{{$userName := .Author.Name}}
							{{if .User}}
								{{if and .User.FullName DefaultShowFullName}}
									{{$userName = .User.FullName}}
								{{end}}
								{{ctx.AvatarUtils.Avatar .User 20}}<a class="muted author-wrapper tw-max-w-full" href="{{.User.HomeLink}}">{{$userName}},</a>
							{{else}}
								{{ctx.AvatarUtils.AvatarByEmail .Author.Email .Author.Name 20}}
								<span class="author-wrapper tw-max-w-full">{{$userName}},</span>
							{{end}}
							{{if .Committer}}
								<div class="text right aligned">{{TimeSince .Committer.When ctx.Locale}}</div>
							{{else}}
								<td class="text right aligned">{{TimeSince .Author.When ctx.Locale}}</td>
							{{end}}
							{{template "repo/commit_statuses" dict "Status" .Status "Statuses" .Statuses}}
						</div>
					</div>
					<div class="tw-col-start-2 tw-row-span-2 tw-flex tw-gap-2 tw-items-center tw-justify-end">
						{{if .Signature}}
								{{template "repo/signature_badge" dict "root" $ "verification" .Verification "shortsha" (ShortSha .ID.String)}}
						{{end}}
						<div>
							{{$commitShaLink := ""}}
							{{if $.PageIsWiki}}
								{{$commitShaLink = (printf "%s/wiki/commit/%s" $commitRepoLink (PathEscape .ID.String))}}
							{{else if $.PageIsPullCommits}}
								{{$commitShaLink = (printf "%s/pulls/%d/commits/%s" $commitRepoLink $.Issue.Index (PathEscape .ID.String))}}
							{{else if $.Reponame}}
								{{$commitShaLink = (printf "%s/commit/%s" $commitRepoLink (PathEscape .ID.String))}}
							{{end}}
							<a {{if $commitShaLink}}href="{{$commitShaLink}}"{{end}} class="commit-hash-link tw-p-2 hover:tw-bg-hover hover:tw-no-underline tw-rounded-lg">{{ShortSha .ID.String}}</a>
						</div>
						<div class="text right aligned tw-py-0">
							<button class="btn interact-bg tw-p-2" data-tooltip-content="{{ctx.Locale.Tr "copy_hash"}}" data-clipboard-text="{{.ID}}">{{svg "octicon-copy"}}</button>
							{{if not $.PageIsWiki}}{{/* at the moment, wiki doesn't support "view at history point*/}}
								{{$viewCommitLink := printf "%s/src/commit/%s" $commitRepoLink (PathEscape .ID.String)}}
								{{if $.FileName}}{{$viewCommitLink = printf "%s/%s" $viewCommitLink (PathEscapeSegments $.FileName)}}{{end}}
								<a class="btn interact-bg tw-p-2" data-tooltip-content="{{ctx.Locale.Tr "repo.commits.view_path"}}" href="{{$viewCommitLink}}">{{svg "octicon-file-code"}}</a>
							{{end}}
						</div>
					</div>
				</li>
			{{end}}
		</ul>
	</div>
</div>
